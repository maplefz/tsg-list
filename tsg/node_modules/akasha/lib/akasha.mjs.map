{"version":3,"file":"akasha.mjs","sources":["../src/cookie-storage.coffee","../src/storage.coffee","../src/local-storage.coffee","../src/pretend-storage.coffee","../src/index.coffee"],"sourcesContent":["import cookies from 'es-cookies'\nimport md5     from 'es-md5'\n\nexport default do ->\n  key = (k) -> \"#{k}\"\n\n  get: (k) ->\n    cookies.getJSON key k\n\n  set: (k, v, opts) ->\n    ks = (cookies.getJSON key '_keys') ? []\n    ks.push k\n    cookies.set (key '_keys'), ks\n    cookies.set (key k, opts), v\n\n  remove: (k) ->\n    cookies.remove key k\n\n  clear: ->\n    ks = (cookies.getJSON key '_keys') ? []\n    for k in ks\n      cookies.remove k\n    cookies.remove key '_keys'\n","export default (backend) ->\n  root  = if typeof window == 'undefined' then global else window\n  try\n    store = root[backend+'Storage']\n  catch err\n    return {\n      get: ->\n        undefined\n      set: ->\n        undefined\n      remove: ->\n        undefined\n      clear: ->\n        undefined\n    }\n\n  get: (k) ->\n    try\n      JSON.parse store.getItem k\n    catch err\n      console.error 'Unable to parse', k\n      undefined\n\n  set: (k, v, opts) ->\n    store.setItem k, JSON.stringify v\n\n  remove: (k) ->\n    store.removeItem k\n\n  clear: ->\n    store.clear()\n","import storage from './storage'\nexport default storage 'local'\n","import cookies from 'es-cookies'\nimport md5     from 'es-md5'\n\nexport default do ->\n  pretendStorage = {}\n\n  key = (k) -> \"#{k}\"\n\n  get: (k) ->\n    pretendStorage[key(k)]\n\n  set: (k, v, opts) ->\n    pretendStorage[key(k)] = v\n\n  remove: (k) ->\n    delete pretendStorage[key(k)]\n\n  clear: ->\n    for key of pretendStorage\n      delete pretendStorage[key(k)]\n","import cookieStorage  from './cookie-storage'\nimport localStorage   from './local-storage'\nimport pretendStorage from './pretend-storage'\n\nsupported = (storage) ->\n  try\n    testStr = '__akasha__test__'\n    storage.set testStr, testStr\n    ok = (storage.get testStr) == testStr\n    storage.remove testStr\n    ok\n  catch err\n    false\n\nexport default do ->\n  if supported localStorage\n    localStorage\n  else if supported cookieStorage\n    cookieStorage\n  else\n    pretendStorage\n"],"names":[],"mappings":";;;;AAAA,AAGA,oBAAkB,CAAA;MAChB;EAAA,GAAA,GAAM,SAAC,CAAD;WAAO,EAAA,GAAG;;SAEhB;IAAA,GAAA,EAAK,SAAC,CAAD;aACH,OAAO,CAAC,OAAR,CAAgB,GAAA,CAAI,CAAJ,CAAhB;KADF;IAGA,GAAA,EAAK,SAAC,CAAD,EAAI,CAAJ,EAAO,IAAP;UACH;MAAA,EAAA,yDAAqC;MACrC,EAAE,CAAC,IAAH,CAAQ,CAAR;MACA,OAAO,CAAC,GAAR,CAAa,GAAA,CAAI,OAAJ,CAAb,EAA2B,EAA3B;aACA,OAAO,CAAC,GAAR,CAAa,GAAA,CAAI,CAAJ,EAAO,IAAP,CAAb,EAA2B,CAA3B;KAPF;IASA,MAAA,EAAQ,SAAC,CAAD;aACN,OAAO,CAAC,MAAR,CAAe,GAAA,CAAI,CAAJ,CAAf;KAVF;IAYA,KAAA,EAAO;UACL;MAAA,EAAA,yDAAqC;WACrC,oCAAA;;QACE,OAAO,CAAC,MAAR,CAAe,CAAf;;aACF,OAAO,CAAC,MAAR,CAAe,GAAA,CAAI,OAAJ,CAAf;KAhBF;;CAHgB;;;ACHlB,cAAe,SAAC,OAAD;MACb;EAAA,IAAA,GAAW,OAAO,MAAP,KAAiB,WAApB,GAAqC,MAArC,GAAiD;;IAEvD,KAAA,GAAQ,IAAK,CAAA,OAAA,GAAQ,SAAR,EADf;GAAA,aAAA;IAEM,OACG;MACL,GAAA,EAAK;eACH;OAFG;MAGL,GAAA,EAAK;eACH;OAJG;MAKL,MAAA,EAAQ;eACN;OANG;MAOL,KAAA,EAAO;eACL;OARG;MAHT;;SAcA;IAAA,GAAA,EAAK,SAAC,CAAD;;eAED,IAAI,CAAC,KAAL,CAAW,KAAK,CAAC,OAAN,CAAc,CAAd,CAAX,EADF;OAAA,aAAA;QAEM,AACJ,OAAO,CAAC,KAAR,CAAc,iBAAd,EAAiC,CAAjC;eACA,OAJF;;KADF;IAOA,GAAA,EAAK,SAAC,CAAD,EAAI,CAAJ,EAAO,IAAP;aACH,KAAK,CAAC,OAAN,CAAc,CAAd,EAAiB,IAAI,CAAC,SAAL,CAAe,CAAf,CAAjB;KARF;IAUA,MAAA,EAAQ,SAAC,CAAD;aACN,KAAK,CAAC,UAAN,CAAiB,CAAjB;KAXF;IAaA,KAAA,EAAO;aACL,KAAK,CAAC,KAAN;KAdF;;;;;AChBF,AACA,mBAAe,OAAA,CAAQ,OAAR;;;ACDf,AAGA,qBAAkB,CAAA;MAChB;EAAA,cAAA,GAAiB;EAEjB,GAAA,GAAM,SAAC,CAAD;WAAO,EAAA,GAAG;;SAEhB;IAAA,GAAA,EAAK,SAAC,CAAD;aACH,cAAe,CAAA,GAAA,CAAI,CAAJ,CAAA;KADjB;IAGA,GAAA,EAAK,SAAC,CAAD,EAAI,CAAJ,EAAO,IAAP;aACH,cAAe,CAAA,GAAA,CAAI,CAAJ,CAAA,CAAf,GAAyB;KAJ3B;IAMA,MAAA,EAAQ,SAAC,CAAD;aACN,OAAO,cAAe,CAAA,GAAA,CAAI,CAAJ,CAAA;KAPxB;IASA,KAAA,EAAO;UACL;;WAAA,qBAAA;qBACE,OAAO,cAAe,CAAA,GAAA,CAAI,CAAJ,CAAA;;;KAX1B;;CALgB;;;ACHlB,IAAA;;AAAA,AAIA,SAAA,GAAY,SAAC,OAAD;MACV;;IACE,OAAA,GAAU;IACV,OAAO,CAAC,GAAR,CAAY,OAAZ,EAAqB,OAArB;IACA,EAAA,GAAK,CAAC,OAAO,CAAC,GAAR,CAAY,OAAZ,CAAD,MAAyB;IAC9B,OAAO,CAAC,MAAR,CAAe,OAAf;WACA,GALF;GAAA,aAAA;IAMM,OACJ,MAPF;;;;AASF,YAAkB,CAAA;EAChB,IAAG,SAAA,CAAU,YAAV,CAAH;WACE,aADF;GAAA,MAEK,IAAG,SAAA,CAAU,aAAV,CAAH;WACH,cADG;GAAA,MAAA;WAGH,eAHG;;CAHW;;;;"}